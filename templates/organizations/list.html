{% extends "base.html" %}
{% block header_title %}Tizim tashkilotlari{% endblock %}
{% block content %}

<div class="page-title">
  <h1>Tizim tashkilotlari</h1>
  <p class="subtitle">Barcha bo‘linmalar, filallar va ularning asosiy ko‘rsatkichlari</p>
</div>

{% if session.get("user_role") in ["admin","manager"] %}
<div style="margin-bottom:15px;">
  <a href="/organizations/create" class="btn btn-primary">+ Yangi tashkilot</a>
</div>
{% endif %}

<div class="org-grid">

  {% for org in organizations %}
  <div class="org-card" onclick="window.location='/organizations/{{ org.id }}'">

      <div class="org-header">
          <h3>{{ org.name }}</h3>
          <span class="org-count">{{ org.employee_count or 0 }} xodim</span>
      </div>

      <div class="org-body">
          <div><b>Manzil:</b> {{ org.address or "—" }}</div>
          <div><b>Qavati:</b> {{ org.floor or "—" }}</div>
      </div>

      <div class="org-footer">
          <small>{{ org.vehicles|length }} ta transport biriktirilgan</small>
      </div>

  </div>
  {% else %}
    <div class="empty-text">Tashkilotlar hali kiritilmagan.</div>
  {% endfor %}

</div>

<style>
.org-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(330px,1fr));
  gap:15px;
}
.org-card{
  background:#1c1f2b;
  padding:18px;
  border-radius:14px;
  border:1px solid #2e3448;
  cursor:pointer;
  transition:0.2s;
}
.org-card:hover{ border-color:#4b6bff; }

.org-header{
  display:flex; justify-content:space-between; margin-bottom:10px;
}
.org-count{
  background:#4b6bff;
  padding:4px 8px;
  border-radius:8px;
  font-size:12px;
}
.org-body div{
  font-size:14px;
  margin-bottom:5px;
}
.org-footer{
  margin-top:12px;
  opacity:0.7;
  font-size:12px;
}
</style>

{% endblock %}
