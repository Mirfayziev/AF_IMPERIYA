{% extends "base.html" %}
{% block content %}

<div class="page-title">
    <h1>OrgTexnika</h1>
</div>

{% if session.get("user_role") in ["admin","manager"] %}
<div style="margin-bottom:15px;">
    <a href="/orgtech/create" class="btn btn-primary">+ Texnika qo‘shish</a>
</div>
{% endif %}

<div class="org-grid">

    {% for t in items %}
    <div class="org-card" onclick="window.location='/orgtech/{{ t.id }}'">

        <div class="org-header">
            <h3>{{ t.name }}</h3>
            <span class="status {{ t.status }}">{{ t.status }}</span>
        </div>

        <div class="org-body">
            <div><b>Model:</b> {{ t.model }}</div>
            <div><b>Serial №:</b> {{ t.serial_number }}</div>
            <div><b>Biriktirilgan:</b> {{ t.assigned_to.username if t.assigned_to else "—" }}</div>
        </div>

        <div class="org-footer">
            <small>Oxirgi yangilanish: {{ t.last_update }}</small>
        </div>

    </div>
    {% else %}
        <div class="empty-text">Texnikalar hali kiritilmagan.</div>
    {% endfor %}

</div>

<style>
.org-grid{
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(330px,1fr));
    gap:15px;
}

.org-card{
    background:#1c1f2b;
    padding:18px;
    border-radius:14px;
    border:1px solid #2e3448;
    transition:0.2s;
    cursor:pointer;
}
.org-card:hover{ border-color:#4b6bff; }

.org-header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:8px;
}

.status{
    padding:4px 8px;
    border-radius:6px;
    font-size:12px;
    text-transform:uppercase;
}
.status.working{ background:#00c853; }
.status.repair{ background:#ffa726; }
.status.broken{ background:#ff5252; }
.status.new{ background:#4b6bff; }

.org-body div{
    font-size:14px;
    margin-bottom:4px;
}

.org-footer{
    margin-top:10px;
    opacity:0.7;
    font-size:12px;
}
</style>

{% endblock %}
