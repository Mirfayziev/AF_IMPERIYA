<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <title>{% block page_title %}AF Imperiya{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>

<div class="app-shell">

    <aside class="sidebar">
        <div class="sidebar-top">
            <div class="logo-wrap">
                <img src="{{ url_for('static', filename='img/logo_af.png') }}" class="logo-img" alt="AF logo">
            </div>
            <div class="user-info">
                <div class="user-name">AF Imperiya</div>
                {% set role = session.get('user_role') %}
                <div class="user-role">
                    {% if role == 'manager' %}Rahbar paneli{% elif role == 'admin' %}Admin paneli{% else %}Xodim paneli{% endif %}
                </div>
            </div>
        </div>

        {% set role = session.get('user_role') %}

        <nav class="sidebar-menu">
            {% if role in ['manager', 'admin'] %}
                <a href="{{ url_for('manager_dashboard') }}" class="menu-item{% if request.endpoint == 'manager_dashboard' %} active{% endif %}">
                    <span class="menu-icon">ğŸ“Š</span><span class="menu-text">Topshiriqlar</span>
                </a>
            {% endif %}

            {% if role in ['manager', 'admin'] %}
                <a href="{{ url_for('vehicles_list') }}" class="menu-item{% if 'vehicles_' in request.endpoint or request.endpoint == 'vehicles_list' %} active{% endif %}">
                    <span class="menu-icon">ğŸš—</span><span class="menu-text">Avtotransportlar</span>
                </a>
            {% endif %}

            {% if role in ['manager', 'admin'] %}
                <a href="{{ url_for('contracts_list') }}" class="menu-item{% if request.endpoint == 'contracts_list' %} active{% endif %}">
                    <span class="menu-icon">ğŸ“„</span><span class="menu-text">Shartnomalar</span>
                </a>
            {% endif %}

            {% if role in ['manager', 'admin'] %}
                <a href="{{ url_for('outsourcing_panel') }}" class="menu-item{% if request.endpoint == 'outsourcing_panel' %} active{% endif %}">
                    <span class="menu-icon">ğŸ¤</span><span class="menu-text">Outsorsing</span>
                </a>
            {% endif %}

            {% if role in ['manager', 'admin'] %}
                <a href="{{ url_for('orgtech_panel') }}" class="menu-item{% if request.endpoint == 'orgtech_panel' %} active{% endif %}">
                    <span class="menu-icon">ğŸ–¨</span><span class="menu-text">Orgtexnika</span>
                </a>
            {% endif %}

            {% if role in ['manager', 'admin'] %}
                <a href="{{ url_for('orgs_list') }}" class="menu-item{% if request.endpoint.startswith('orgs_') %} active{% endif %}">
                    <span class="menu-icon">ğŸ¢</span><span class="menu-text">Tizim tashkilotlar</span>
                </a>
            {% endif %}

            {% if role in ['manager', 'admin'] %}
                <a href="{{ url_for('ijro_panel') }}" class="menu-item{% if request.endpoint == 'ijro_panel' or request.endpoint=='ijro_create' %} active{% endif %}">
                    <span class="menu-icon">ğŸ“…</span><span class="menu-text">Ijro</span>
                </a>
            {% endif %}

            {% if role in ['manager', 'admin'] %}
                <a href="{{ url_for('solar_panel') }}" class="menu-item{% if request.endpoint == 'solar_panel' %} active{% endif %}">
                    <span class="menu-icon">â˜€</span><span class="menu-text">Solar</span>
                </a>
            {% endif %}

            {% if role in ['manager', 'admin'] %}
                <a href="{{ url_for('hr_panel') }}" class="menu-item{% if request.endpoint == 'hr_panel' %} active{% endif %}">
                    <span class="menu-icon">ğŸ‘¥</span><span class="menu-text">Xodimlar</span>
                </a>
            {% endif %}

            {% if role == 'employee' %}
                <a href="{{ url_for('employee_panel') }}" class="menu-item{% if request.endpoint == 'employee_panel' %} active{% endif %}">
                    <span class="menu-icon">ğŸ“Œ</span><span class="menu-text">Mening topshiriqlarim</span>
                </a>
                <a href="{{ url_for('ijro_panel') }}" class="menu-item{% if request.endpoint == 'ijro_panel' %} active{% endif %}">
                    <span class="menu-icon">ğŸ“…</span><span class="menu-text">Ijro</span>
                </a>
            {% endif %}
        </nav>

        <div class="sidebar-bottom">
            <a href="{{ url_for('logout') }}" class="menu-item logout">
                <span class="menu-icon">ğŸšª</span><span class="menu-text">Chiqish</span>
            </a>
        </div>
    </aside>

    <main class="main-panel">
        <header class="topbar">
            <div class="topbar-left">
                <h1 class="topbar-title">
                    {% block header_title %}Panel{% endblock %}
                </h1>
            </div>
            <div class="topbar-right">
                <div class="search-box">
                    <input type="text" placeholder="Qidirish..." />
                </div>
                <div class="topbar-user">
                    <div class="avatar-small">AF</div>
                    <div class="topbar-user-name">
                        {% if role == 'manager' %}Rahbar{% elif role == 'admin' %}Admin{% else %}Xodim{% endif %}
                    </div>
                </div>
            </div>
        </header>

        <section class="top-messages">
            {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="flash flash-{{ category }}">{{ message }}</div>
                {% endfor %}
            {% endif %}
            {% endwith %}
        </section>

        <section class="dashboard-content">
            {% block content %}{% endblock %}
        </section>
    </main>
</div>

</body>
</html>
